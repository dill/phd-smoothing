% "Brief" explanation of the Schwarz-Christoffel transform
% David Lawrence Miller
% d.l.miller@bath.ac.uk

% Started : 29 October 2008

\documentclass[a4paper,10pt]{amsart}

% Load some packages
\usepackage{times, amsmath, amssymb, amsfonts, url, natbib, bm, rotating}

\usepackage{multirow}
\usepackage{graphicx}

% top matter
\title{a title}
\author{David Lawrence Miller}
\email{d.l.miller@bath.ac.uk}
\address{Mathematical Sciences, University of Bath, Bath, United Kingdom}

% Shortcuts
% Probability
\newcommand{\prob}[1]{\mathbb{P}\left[ #1 \right]}
% Hovitz-Thompson
\newcommand{\HT}{\hat{\tau}_{HT}}
% Schwarz-Christoffel
\newcommand{\sch}{Schwarz-Christoffel }
% fprime
\newcommand{\fprime}{f^\prime(z)}

\begin{document}

% The abstract
\begin{abstract}
abstract from useR?
\end{abstract}


% New theorem for theorems
\newtheorem{thm}{Theorem}[section]

%New theorem for definitions
\newtheorem{defn}{Definition}[section]

\maketitle



\section{Ramsey's horseshoe}

\cite{ramsay} proposes a function which can be used to benchmark new approaches to 2-dimensional smoothing. The function takes the form of a horseshoe which is flat across the domain but ranges from $-4$ to $4$ along the domain's long axis. The so-called ``Ramsay horseshoe'' is shown in \ref{ramsayshorseshoe}.

The test function highlights a common in spatial smoothing, that of ``leakage''. When a Euclidean distance metric is used then the model thinks that the distance between the two end points of the horseshoe is the distance over the gap in between them, rather than the distance along the major axis of the shape. This causes the high density from one side to contaminate the other (or the low to contaminate the high.) It is easy to see that this causes bias in the estimation of the smooth.

\begin{table}
\centering
\begin{tabular}{c}
\includegraphics[scale=0.25]{figs/ramsayhorseshoe.pdf} \\
\end{tabular}
\caption{Heatmap of the Ramsay horseshoe.}
\label{rtest}
\end{table}

Clearly we would like to use an approach that respects the shape of the region and does not show any evidence of leakage. In order to deal with the problems of a complex region, four different approaches have been proposed:

\begin{enumerate}
\item \cite{ramsay} proposes finite area $L$-splines (FELSPLINEs.) These consist of triangulating the domain and then constructing a set of bivariate quadratic polynomial basis functions over each triangle, specifying that there be continuity over the edges of the triangles. The union of these functions is then a solution to a PDE.

FELSPLINE does not perform very well in practice since it specifies that the gradient is normal to the edge of the area. This is not neccessarily physically realistic in all situations.

\item \cite{wangranalli} adopt a ``within-area distance'' formulation for thin plate splines. In this case they take the geodesic distance between two points, that being the shortest path within the domain in order to address the problem of the definition of ``close'' in the domain. 

Since the geodesic distance is only known if the intrinsic structure of the domain is known (which is rare in ecological examples), the authors use a different method to calculate the shortest path. For this they create a graph of the data points, with nodes at each point and the linear interpolant between the nodes. Floyd's algorithm is then run to find the $k$ nearest neighbors of each node. Unfortunately this is $\mathcal{O}(N^3)$ if $N$ is the number of datum.


\item \cite{soap} consider a soap film over the domain which is weighed down by the data whilst minimizing the surface tension in the film.

\item An alternative approach is to ``morph'' the area in question to be one that is more suitable for smoothing upon. This is what we propose here. For example, with Ramsay's horseshoe, it seems intuitive to simply bend the horseshoe back to a long strip and then smooth on that domain. This is the case for many such domains.

The major hurdle that this approach faces is that the nullspace of the smooth in the transformed space is not the same as it was.

\end{enumerate}




\section{Method}

Here we formulate a conformal mapping from the domain of the problem (we call this the $W$ domain) to a domain on which it is easier to smooth (and where we can avoid the problems detailed above.)

\subsection{\sch}

The \sch transform provides a way to map an arbitrary polygon in the complex plane to one of a set of objects (also in the complex plane) in a certain manner. The two most commonly mapped to objects are the unit disk and the rectangle. The procedure consists of adding vertices to the object you wish to map to and then deforming it iteratively until it is identical to the polygon.

Full technical details are given in \cite{miller08}


\subsection{Problems}

Linear fit onto the horseshoe.
Look at some other shapes that break it.



\subsection{Procedure}

Our procedure consists of the following steps:

\begin{enumerate}
\item Determine the domain over which we would like to smooth, $W$.

\item Compute the \sch transform of $W$ to get $Z$.

\item Map the co-ordinates of the datapoints in $W$ to $Z$.

\item Fit the GAM to the data in $Z$.

\end{enumerate}

Say something about:
Doing analysis in $Z$, doing analysis in $W$.




Brief bit about SC.

Algorithm that we use.

Matlab+R approach.



\section{Simulations}

What do we want to look at?

Why p-splines?


\section{Analysis}


Linear model stuff, will this work elsewhere?





Modified horseshoe with the ridge in the middle








\bibliographystyle{plainnat}
\bibliography{sc-refs}



\end{document}
